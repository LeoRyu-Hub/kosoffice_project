<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.koffice.main.dao.mainDao">

	<resultMap type = "com.koffice.vo.manager.managerInfoVO" id = "managerMap">
		<result column = "MANAGER_ID" 			property = "managerId"/>
		<result column = "MANAGER_PWD" 			property = "managerPwd"/>
		<result column = "MANAGER_NAME" 		property = "managerName"/>
		<result column = "SALES_DT" 			property = "salesDt"/>
		<result column = "SP" 					property = "sp"/>
	</resultMap>
	
	<select id="selectManager" resultMap="managerMap">
	SELECT 
	MANAGER_PWD,
	MANAGER_NAME	
	FROM TBL_MANAGER_INFO
	WHERE MANAGER_ID=#{managerId}
	</select>
	
	<select id="getTodayOrder" resultType="int">
		SELECT COUNT(ORDER_DT)
		FROM TBL_ORDER_INFO
		WHERE TRUNC(ORDER_DT)=TRUNC(SYSDATE)
	</select>
	
	<select id="getYesterdayOrder" resultType="int">
		SELECT COUNT(ORDER_DT)
		FROM TBL_ORDER_INFO
		WHERE TRUNC(ORDER_DT)=TRUNC(SYSDATE)-1
	</select>
	
	<select id="getTodaySales" resultType="int">
	SELECT SP AS SALES_PRICE
    	FROM(
        SELECT SUM(PAY_PRICE) SP
        FROM TBL_ORDER_INFO
        WHERE TRUNC(ORDER_DT) = TRUNC(SYSDATE))
	</select>
	
	<select id="getYesterdaySales" resultType="int">
	SELECT SP AS SALES_PRICE
    	FROM(
        SELECT SUM(PAY_PRICE) SP
        FROM TBL_ORDER_INFO
        WHERE TRUNC(ORDER_DT) = TRUNC(SYSDATE)-1)
	</select>
	
	<select id="getChartInfo" resultMap="managerMap">
	SELECT TO_CHAR(ORDER_DT,'YYYY-MM-DD') SALES_DT, SUM(PAY_PRICE) SP
	FROM TBL_ORDER_INFO
	WHERE TO_CHAR(ORDER_DT,'YYYYMMDD')<![CDATA[>=]]>TO_CHAR(SYSDATE-6 ,'YYYYMMDD')
	AND TO_CHAR(ORDER_DT,'YYYYMMDD')<![CDATA[<=]]>TO_CHAR(SYSDATE ,'YYYYMMDD')
	GROUP BY TO_CHAR(ORDER_DT,'YYYY-MM-DD')
	ORDER BY TO_CHAR(ORDER_DT, 'YYYY-MM-DD') ASC
	</select>

</mapper>